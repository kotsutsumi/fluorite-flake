import { list } from '@vercel/blob';

async function checkBlobConfiguration() {
  try {
    console.log('🔍 Checking Vercel Blob configuration...');

    // Try to list blobs to verify the token works
    const result = await list({ limit: 1 });

    console.log('✅ Vercel Blob is configured correctly!');
    console.log(`   Found ${result.blobs.length} blob(s) in storage`);

    return true;
  } catch (error: any) {
    console.error('❌ Vercel Blob configuration error:');

    if (error.message?.includes('BLOB_READ_WRITE_TOKEN')) {
      console.error('   Token is not set or invalid');
      console.error('   Run: npm run setup:blob');
    } else {
      console.error('  ', error.message);
    }

    return false;
  }
}

// Run check if this file is executed directly
if (require.main === module) {
  checkBlobConfiguration().then(success => {
    process.exit(success ? 0 : 1);
  });
}

export { checkBlobConfiguration };