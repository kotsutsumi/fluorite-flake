# TrusoCLIのnodeラッパー作成

[ STATUS:DONE ]

TrusoCLIを直接nodeから利用するとシェル実行のエラー処理などで煩雑になるのを実装側で避けるために
TrusoCLIのラッパーモジュールを作成してください。
実際に、TrusoCLIが利用できています（認証済み）、テスト作成時、モックテストを準備してほしいですが、
実装時には実際に操作して構いません。
そうしないと返却される値が正確に確認できないためです。
ただ、テスト実行時に毎回プロジェクトが作られるなどされるとこまるので、そこはモックテストにしておいてください。

## 調査メモ（2025-10-04）

- 公開中の公式ドキュメント（`https://docs.turso.tech/cli/…`）、Platform Saga ブログ、および `tursodatabase/turso-docs` リポジトリの CLI セクション（`temp/turso-cli/cli_*.mdx`）を精査し、コマンドとフラグを確認。
- CLI v0.93 系（2025-10 現在）を前提。`turso <cmd> --help` で最新差分を再確認する運用を推奨。

## コマンド・フラグ一覧

以下はトップレベル CLI コマンド別に、主要サブコマンドとドキュメント記載のフラグを整理したもの。用途欄は CLI ドキュメント／公式ブログで言及されている主目的を要約。

### auth（認証・API トークン）

- `turso auth login`：GitHub SSO を開いて CLI を認証。`--headless` でブラウザを開けない環境（WSL/CI 等）向けに即時トークン取得。citeturn2search3
- `turso auth logout`：セッション無効化。`-a, --all` で全セッション一括失効。citeturn2search0
- `turso auth signup`：新規アカウント作成。`--headless` で CLI 内完結。citeturn2search2
- `turso auth token`：現在の CLI API トークンを表示（1 週間で失効）。Platform Saga Part II で運用指針を確認可能。citeturn2search5
- `turso auth whoami`：現在ログイン中ユーザーを表示（ドキュメント `cli/auth/whoami`）。※リポジトリ `temp/turso-cli/cli_auth_whoami.mdx` 参照。
- `turso auth api-tokens list`：組織スコープの API トークン一覧。citeturn15search0
- `turso auth api-tokens mint <token-name>`：恒久トークンを発行。citeturn15search7
- `turso auth api-tokens revoke <token-name>`：トークン失効。citeturn15search9

### contact（サポート連携）

- `turso contact feedback`：CLI からフィードバック送信。citeturn3search0
- `turso contact bookmeeting`：ミーティング予約（`temp/turso-cli/cli_contact_bookmeeting.mdx` 参照、Web UI リダイレクト）。

### db（データベース操作）

- `turso db create [name]`：DB 作成。主なフラグ：`--group`（特定グループへ）、`--from-file`/`--from-dump`/`--from-csv`、`--timestamp`（PITR）、`--enable-extensions`、`--size-limit`、`--canary`、`-w/--wait`。citeturn4search2
- `turso db destroy <name>`：DB/レプリカ削除。`-y, --yes` で確認スキップ。citeturn4search6
- `turso db list`：DB 一覧。`--group` でフィルター。citeturn5search4
- `turso db show <name>`：メタ情報と URL 出力。`--url`/`--http-url`。citeturn5search0
- `turso db locations`：対応リージョン一覧。`-l, --show-latencies` でレイテンシ表示。citeturn7search6
- `turso db shell <name> [SQL]`：対話／ワンショット実行。`--instance`、`--location`、`--proxy` を指定可能。citeturn4search3
- `turso db inspect <name>`：使用量確認。`--queries`（上位クエリ）、`--verbose`（詳細）。citeturn4search1
- `turso db import <file>`：SQLite ファイル取り込み。`--group`、`-h/--help`。citeturn4search5
- `turso db export <name>`：スナップショット出力（`temp/turso-cli/cli_db_export.mdx` 参照。`--output-file`、`--overwrite`、`--with-metadata`、`-h/--help`）。
- `turso db tokens create <name>`：DB トークン生成。`-e/--expiration`、`-r/--read-only`。citeturn4search4
- `turso db tokens invalidate <name>`：DB トークン全失効。`-y/--yes`。citeturn4search0
- `turso db unarchive <name>`：アーカイブ解除（`temp/turso-cli/cli_db_wakeup.mdx` 参照）。

### group（グループ／レプリカ制御）

- `turso group list`：グループ一覧。citeturn7search6
- `turso group create <name>`：グループ作成。`--location`、`--canary`、`-w/--wait`。citeturn7search0
- `turso group destroy <name>`：グループ削除。`-y/--yes`。citeturn8search8
- `turso group update <name>`：バージョン／拡張設定更新。`--version`、`--extensions`、`-y/--yes`。citeturn16search6
- `turso group transfer <name> <org>`：他組織へ移管。`-y/--yes`。citeturn16search5
- `turso group locations add <name> <location>`：レプリカ追加。`-w/--wait`。citeturn6search1
- `turso group locations remove <name> <location>`：レプリカ削除（API リファレンスベース）。citeturn16search4
- `turso group tokens create <name>`：グループ全 DB にアクセスするトークン発行。`-e/--expiration`、`-r/--read-only`。citeturn6search4
- `turso group tokens invalidate <name>`：グループトークン失効。`-y/--yes`。citeturn4search9
- `turso group unarchive <name>`：グループのスリープ解除。citeturn6search7
- `turso group aws-migration info|start|abort <name>`：Fly.io→AWS 移行ワークフロー。各サブコマンドは情報表示／移行実行／移行中止。citeturn6search2turn6search3turn11search9

### org（組織・メンバー・課金）

- `turso org list`：所属組織一覧。citeturn9search3
- `turso org create <name>`：新規組織作成（支払い情報必須）。citeturn9search2
- `turso org switch <slug>`：アクティブ組織切替。citeturn9search4
- `turso org destroy <slug>`：組織削除（プロジェクト事前整理が必要）。citeturn16search0
- `turso org members list`：メンバー一覧。citeturn9search1
- `turso org members add <username>`：既存ユーザー追加。`-a/--admin` で管理者権限付与。citeturn9search0
- `turso org members invite <email>`：非登録ユーザー招待。`-a/--admin`。citeturn7search7
- `turso org members rm <username>`：メンバー削除。citeturn7search7
- `turso org billing` 関連 API：`/subscription`（現行プラン）、`/invoices`（請求書）、`/usage`（使用量）。CLI からは `turso plan show/select/upgrade/overages` を利用（下記）。citeturn11search1turn11search5turn15search5

### plan（プラン・オーバージ）

- `turso plan show`：現在のプランと使用量サマリ。citeturn14search1
- `turso plan select`：プラン切替。クレジットカード登録が必要。citeturn14search2
- `turso plan upgrade`：有料プランへアップグレード。citeturn14search5
- `turso plan overages enable` / `disable`：オーバージ課金の有効化／無効化。citeturn14search6turn14search7

### dev / update / help（開発補助）

- `turso dev [--db-file <file>]`：ローカル libSQL サーバーを起動。SDK から `http://127.0.0.1:8080` へ接続。citeturn13search4
- `turso update`：CLI 自体を最新化。macOS は `brew update && brew upgrade`、Linux/WSL は `turso update`。citeturn12search10
- `turso help`：全コマンドの概要と `--help` の使い方を表示。citeturn13search9

## 追加メモ

- CLI ドキュメントは `tursodatabase/turso-docs` リポジトリで MDX として公開されており、本ファイルでは未引用コマンド（例：`turso contact bookmeeting`、`turso db export`、`turso db unarchive` など）もローカル確認済み。実装差分が入りやすい領域のため、該当ファイル（`temp/turso-cli/cli_*.mdx`）と `turso <cmd> --help` をあわせて参照してから開発に着手すること。
